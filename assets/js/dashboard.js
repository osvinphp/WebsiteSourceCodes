"use strict";var Dashboard={init:function(){Dashboard.main()},main:function(){App.getUrlParameter("welcome")&&App.welcomeMessage("Welcome back "+window.firstName,"inverse")},fetchRealtimeVisitors:function(){App.ajax(App.baseUrl("google_analytics/getRealtimeVisitors"),"get","json",null).error(function(t){}).done(function(t){$("#visitors-right-now").text(t),setTimeout(Dashboard.fetchRealtimeVisitors,6e4)})},fetchTodayVisitors:function(){App.ajax(App.baseUrl("dashboard/todayVisitors"),"get","json",null).error(function(t){}).done(function(t){Dashboard.loadWorldMap(t.country),$("#visitors-12-hours").text(t.last12),$("#visitors-24-hours").text(t.last24),setTimeout(Dashboard.fetchRealtimeVisitors,36e4)})},fetchTodayHits:function(){App.blockElement($("#realtime-visitor-list").parent()),App.ajax(App.baseUrl("dashboard/todayHits"),"get","json",null).error(function(t){}).done(function(t){App.unblockElement($("#realtime-visitor-list").parent()),Dashboard.loadTodayHits(t)})},loadTodayHits:function(t){$("#realtime-visitor-list").empty(),$.each(t,function(t,e){var a=moment.tz(e.time,"Australia/Sydney").format("dddd, MMMM D, HH:mm:ss")+" ("+moment.tz(e.time,"Australia/Sydney").fromNow()+")";$("#realtime-visitor-list").append('                    <div class="list-group-item">                        <div class="lgi-text">'+a+'</div>                        <ul class="lgi-attrs">                            <li><img class="analytics-img-country" src="assets/img/flags/'+e.country+'.png" alt="">'+e.country+"</li>                            <li>"+e.operatingSystem+"</li>                            <li>"+e.appVersion+"</li>                        </ul>                    </div>                ")}),$("#realtime-visitor-list").mCustomScrollbar({theme:"minimal-dark",scrollInertia:100,axis:"yx",mouseWheel:{enable:!0,axis:"y",preventDefault:!0}})},loadWorldMap:function(t){$("#map-world").empty(),$("#map-world").vectorMap({map:"world_en",backgroundColor:null,color:"#eee",borderColor:"#eee",hoverOpacity:1,selectedColor:"#00BCD4",enableZoom:!0,showTooltip:!0,normalizeFunction:"polynomial",selectedRegions:t,onRegionClick:function(t){t.preventDefault()}})},loadFlotChart:function(){for(var t=[],e=0;e<=10;e+=1)t.push([e,parseInt(30*Math.random())]);for(var a=[],e=0;e<=20;e+=1)a.push([e,parseInt(30*Math.random())]);for(var o=[],e=0;e<=10;e+=1)o.push([e,parseInt(30*Math.random())]);$("#curved-line-chart")[0]&&$.plot($("#curved-line-chart"),[{data:t,lines:{show:!0,fill:.98},label:"Product 1",stack:!0,color:"#e3e3e3"},{data:o,lines:{show:!0,fill:.98},label:"Product 2",stack:!0,color:"#f1dd2c"}],{series:{shadowSize:0,curvedLines:{apply:!0,active:!0,monotonicFit:!0},lines:{show:!1,lineWidth:0,fill:1}},grid:{borderWidth:0,labelMargin:10,hoverable:!0,clickable:!0,mouseActiveRadius:6},xaxis:{tickDecimals:0,ticks:!1},yaxis:{tickDecimals:0,ticks:!1},legend:{show:!1}}),$(".flot-chart")[0]&&($(".flot-chart").bind("plothover",function(t,e,a){if(a){var o=a.datapoint[0].toFixed(2),r=a.datapoint[1].toFixed(2);$(".flot-tooltip").html(a.series.label+" of "+o+" = "+r).css({top:a.pageY+5,left:a.pageX+5}).show()}else $(".flot-tooltip").hide()}),$("<div class='flot-tooltip' class='chart-tooltip'></div>").appendTo("body"))},loadWidget:function(){function t(t,e,a,o,r,i){$("."+t).sparkline(e,{type:"bar",height:a,barWidth:o,barColor:r,barSpacing:i})}function e(t,e,a,o,r,i,s,l,n,c,f,d,p){$("."+t).sparkline(e,{type:"line",width:a,height:o,lineColor:r,fillColor:i,lineWidth:s,maxSpotColor:l,minSpotColor:n,spotColor:c,spotRadius:f,highlightSpotColor:d,highlightLineColor:p})}var a=$(".stats-bar-worlwide-users").data("chart");t("stats-bar-worlwide-users",a,"35px",3,"#fff",2),t("stats-bar-active-users",a=$(".stats-bar-active-users").data("chart"),"35px",3,"#fff",2),e("stats-line-posts",a=$(".stats-line-posts").data("chart"),68,35,"#fff","rgba(0,0,0,0)",1.25,"rgba(255,255,255,0.4)","rgba(255,255,255,0.4)","rgba(255,255,255,0.4)",3,"#fff","rgba(255,255,255,0.4)"),e("stats-line-reports",a=$(".stats-line-reports").data("chart"),68,35,"#fff","rgba(0,0,0,0)",1.25,"rgba(255,255,255,0.4)","rgba(255,255,255,0.4)","rgba(255,255,255,0.4)",3,"#fff","rgba(255,255,255,0.4)"),$(".stats-bar-messages")[0]&&t("stats-bar-messages",a=$(".stats-bar-messages").data("chart"),"35px",3,"#fff",2),$(".stats-bar-calls")[0]&&t("stats-bar-calls",a=$(".stats-bar-calls").data("chart"),"35px",3,"#fff",2),$(".stats-line-flicklinks")[0]&&e("stats-line-flicklinks",a=$(".stats-line-flicklinks").data("chart"),68,35,"#fff","rgba(0,0,0,0)",1.25,"rgba(255,255,255,0.4)","rgba(255,255,255,0.4)","rgba(255,255,255,0.4)",3,"#fff","rgba(255,255,255,0.4)"),$(".stats-line-comments")[0]&&e("stats-line-comments",a=$(".stats-line-comments").data("chart"),68,35,"#fff","rgba(0,0,0,0)",1.25,"rgba(255,255,255,0.4)","rgba(255,255,255,0.4)","rgba(255,255,255,0.4)",3,"#fff","rgba(255,255,255,0.4)")},fetchUserVisitData:function(){App.blockElement($("#visit-over-time").parent()),App.ajax(App.baseUrl("dashboard/userVisits"),"get","json",null).error(function(t){}).done(function(t){App.unblockElement($("#visit-over-time").parent()),Dashboard.loadUserVisitChart(t),Dashboard.loadAppVersionChart(t)})},loadUserVisitChart:function(t){function e(t,e,a){return new Date(t,e-1,a).getTime()}var a=[],o=[];$.each(t.users,function(t,o){var r=moment(t).format("YYYY"),i=moment(t).format("MM"),s=moment(t).format("DD");a.push([e(r,i,s),o])}),$.each(t.newUsers,function(t,a){var r=moment(t).format("YYYY"),i=moment(t).format("MM"),s=moment(t).format("DD");o.push([e(r,i,s),a])});var r=[{label:"Users",data:a,color:"#ff766c",points:{fillColor:"#ff766c",show:!0,radius:2},lines:{show:!0,lineWidth:1}},{label:"New Users",data:o,xaxis:2,color:"#03A9F4",points:{fillColor:"#03A9F4",show:!0,radius:2},lines:{show:!0,lineWidth:1}}],i=["Sun","Mon","Tue","Wed","Thr","Fri","Sat"],s={series:{shadowSize:0},grid:{borderWidth:1,borderColor:"#f3f3f3",show:!0,clickable:!0,hoverable:!0,mouseActiveRadius:20,labelMargin:10},xaxes:[{color:"#f3f3f3",mode:"time",tickFormatter:function(t,e){return i[new Date(t).getDay()]},position:"top",font:{lineHeight:13,style:"normal",color:"#9f9f9f"}},{color:"#f3f3f3",mode:"time",timeformat:"%m/%d",font:{lineHeight:13,style:"normal",color:"#9f9f9f"}}],yaxis:{ticks:2,color:"#f3f3f3",tickDecimals:0,font:{lineHeight:13,style:"normal",color:"#9f9f9f"}},legend:{container:".flc-visits",backgroundOpacity:.5,noColumns:0,font:{lineHeight:13,style:"normal",color:"#9f9f9f"}}};$("#visit-over-time")[0]&&$.plot($("#visit-over-time"),r,s)},fetchTimeVisitData:function(){App.blockElement($("#visit-server-time").parent()),App.ajax(App.baseUrl("dashboard/timeVisits"),"get","json",null).error(function(t){}).done(function(t){App.unblockElement($("#visit-server-time").parent()),Dashboard.loadServerTimeChart(t)})},loadServerTimeChart:function(t){var e=[];$.each(t.users,function(t,a){e.push([parseInt(t),a])});var a=[{data:e,label:"Visits",bars:{show:!0,barWidth:.4,order:1,lineWidth:0,fillColor:"#ff766c"}}];$("#visit-server-time")[0]&&$.plot($("#visit-server-time"),a,{grid:{borderWidth:1,borderColor:"#f3f3f3",show:!0,hoverable:!0,clickable:!0,labelMargin:10},yaxis:{tickColor:"#f3f3f3",tickDecimals:0,font:{lineHeight:13,style:"normal",color:"#9f9f9f"},shadowSize:0},xaxis:{tickFormatter:function(t,e){return t+"h"},tickColor:"#fff",tickDecimals:0,font:{lineHeight:13,style:"normal",color:"#9f9f9f"},shadowSize:0},legend:{show:!1}})},fetchServerStatusData:function(){App.blockElement($("#dynamic-chart").parent()),App.ajax(App.baseUrl("google"),"get","json",null).error(function(t){}).done(function(t){App.unblockElement($("#dynamic-chart").parent()),Dashboard.loadServerStatusChart(t),setTimeout(Dashboard.fetchServerStatusData,6e4)})},loadServerStatusChart:function(t){$.plot("#dynamic-chart",[t.points],{series:{label:"Server Process Data",lines:{show:!0,lineWidth:.2,fill:.6},color:t.max>=70?"#ff766c":"#00BCD4",shadowSize:0},yaxis:{min:0,max:t.max,tickColor:"#eee",font:{lineHeight:13,style:"normal",color:"#9f9f9f"},shadowSize:0},xaxis:{tickColor:"#eee",show:!0,font:{lineHeight:13,style:"normal",color:"#9f9f9f"},shadowSize:0,min:0,max:250},grid:{borderWidth:1,borderColor:"#eee",labelMargin:10,hoverable:!0,clickable:!0,mouseActiveRadius:6},legend:{show:!1}})},fetchAppVersionData:function(t){App.blockElement($("#app-version-chart").parent()),App.ajax(App.baseUrl("dashboard/appVersion"),"get","json",null).error(function(t){}).done(function(t){App.unblockElement($("#app-version-chart").parent()),Dashboard.loadAppVersionChart(t)})},loadAppVersionChart:function(t){Highcharts.chart("app-version-chart",{chart:{type:"column"},title:{text:null},xAxis:{categories:t.categories},yAxis:{min:0,stackLabels:{enabled:!0,style:{fontWeight:"bold",color:Highcharts.theme&&Highcharts.theme.textColor||"gray"}}},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>Total: {point.stackTotal}"},plotOptions:{column:{stacking:"normal",dataLabels:{enabled:!1,color:Highcharts.theme&&Highcharts.theme.dataLabelsColor||"white"}},series:{stacking:"normal",borderColor:"transparent"}},colors:["#0275a8","#0286c2","#0398db","#03a9f4","#14b4fc","#2ebcfc","#47c4fd"],series:t.series})}};
"use strict";var dateStart=moment().subtract(1,"hour").format("YYYY-MM-DD H:mm:ss"),dateEnd=moment().format("YYYY-MM-DD H:mm:ss"),cpuUsage=$("#cpu-usage"),cpuUsageRange=$(".btn-range-cpu"),diskUsage=$("#disk-usage"),diskUsageRange=$(".btn-range-disk"),diskOperationUsage=$("#disk-operation-usage"),diskOperationUsageRange=$(".btn-range-disk-operation"),networkBytes=$("#network-bytes"),networkBytesRange=$(".btn-network-bytes"),serverLogs=$("#server-logs"),serverLogsList=$("#server-logs-list"),serverLogsLoadMore=$("#server-logs-load-more"),serverLogsPageToken=null,Server={init:function(){Server.main(),Server.fetchCpuUsage(dateStart,dateEnd),Server.fetchDiskUsage(dateStart,dateEnd),Server.fetchDiskOperationUsage(dateStart,dateEnd),Server.fetchNetworkBytes(dateStart,dateEnd),Server.fetchServerLogs()},main:function(){$(".btn-range").click(function(){$(this).closest(".btn-group").find(".btn-range").removeClass("btn-primary btn-default").addClass("btn-default"),$(this).addClass("btn-primary")}),$(document).on("click",".btn-expand",function(){$(this).removeClass("btn-expand").addClass("btn-collapse").find(".zmdi").removeClass("zmdi-plus").addClass("zmdi-minus"),$(this).closest(".list-group-item").find(".media-content").slideDown()}),$(document).on("click",".btn-collapse",function(){$(this).removeClass("btn-collapse").addClass("btn-expand").find(".zmdi").removeClass("zmdi-minus").addClass("zmdi-plus"),$(this).closest(".list-group-item").find(".media-content").slideUp()}),cpuUsageRange.click(function(){var e=$(this).data("count"),t=$(this).data("units");dateStart=moment().subtract(e,t).format("YYYY-MM-DD H:mm:ss"),Server.fetchCpuUsage(dateStart,dateEnd)}),diskUsageRange.click(function(){var e=$(this).data("count"),t=$(this).data("units");dateStart=moment().subtract(e,t).format("YYYY-MM-DD H:mm:ss"),Server.fetchDiskUsage(dateStart,dateEnd)}),diskOperationUsageRange.click(function(){var e=$(this).data("count"),t=$(this).data("units");dateStart=moment().subtract(e,t).format("YYYY-MM-DD H:mm:ss"),Server.fetchDiskOperationUsage(dateStart,dateEnd)}),networkBytesRange.click(function(){var e=$(this).data("count"),t=$(this).data("units");dateStart=moment().subtract(e,t).format("YYYY-MM-DD H:mm:ss"),Server.fetchNetworkBytes(dateStart,dateEnd)}),serverLogsLoadMore.find("button").click(function(){serverLogsPageToken=$(this).val(),Server.fetchServerLogs()})},fetchCpuUsage:function(e,t){App.blockElement(cpuUsage),App.ajax(App.baseUrl("server/getCpuUsage"),"get","json",{start:e,end:t}).error(function(e){}).done(function(e){App.unblockElement(cpuUsage),Server.loadCpuUsage(e)})},loadCpuUsage:function(e){Highcharts.chart("cpu-usage-chart",{chart:{type:"line"},title:{text:null},xAxis:{type:"datetime",labels:{formatter:function(){return moment.unix(this.value).format("hh:mm A")}}},yAxis:{title:{text:"% CPU"}},tooltip:{shared:!0,formatter:function(){var e="<b>"+moment.unix(this.x).format("MMM D, YYYY hh:mm A")+"</b><br/>";return $.each(this.points,function(t,s){e+='<span style="color:'+s.color+'">●</span> '+s.series.name+": <b>"+s.y.toFixed(2)+"%</b><br/>"}),e}},credits:{enabled:!1},series:e.series})},fetchDiskUsage:function(e,t){App.blockElement(diskUsage),App.ajax(App.baseUrl("server/getDiskUsage"),"get","json",{start:e,end:t}).error(function(e){}).done(function(e){App.unblockElement(diskUsage),Server.loadDiskUsage(e)})},loadDiskUsage:function(e){Highcharts.chart("disk-usage-chart",{chart:{type:"line"},title:{text:null},xAxis:{type:"datetime",labels:{formatter:function(){return moment.unix(this.value).format("hh:mm A")}}},yAxis:{title:{text:"% DISK"}},tooltip:{shared:!0,formatter:function(){var e="<b>"+moment.unix(this.x).format("MMM D, YYYY hh:mm A")+"</b><br/>";return $.each(this.points,function(t,s){e+='<span style="color:'+s.color+'">●</span> '+s.series.name+": <b>"+s.y+"</b><br/>"}),e}},credits:{enabled:!1},series:e.series})},fetchDiskOperationUsage:function(e,t){App.blockElement(diskOperationUsage),App.ajax(App.baseUrl("server/getDiskOperationUsage"),"get","json",{start:e,end:t}).error(function(e){}).done(function(e){App.unblockElement(diskOperationUsage),Server.loadDiskOperationUsage(e)})},loadDiskOperationUsage:function(e){Highcharts.chart("disk-operation-usage-chart",{chart:{type:"line"},title:{text:null},xAxis:{type:"datetime",labels:{formatter:function(){return moment.unix(this.value).format("hh:mm A")}}},yAxis:{title:{text:"% DISK"}},tooltip:{shared:!0,formatter:function(){var e="<b>"+moment.unix(this.x).format("MMM D, YYYY hh:mm A")+"</b><br/>";return $.each(this.points,function(t,s){e+='<span style="color:'+s.color+'">●</span> '+s.series.name+": <b>"+s.y+"</b><br/>"}),e}},credits:{enabled:!1},series:e.series})},fetchNetworkBytes:function(e,t){App.blockElement(networkBytes),App.ajax(App.baseUrl("server/getNetworkBytes"),"get","json",{start:e,end:t}).error(function(e){}).done(function(e){App.unblockElement(networkBytes),Server.loadNetworkBytes(e)})},loadNetworkBytes:function(e){Highcharts.chart("network-bytes-chart",{chart:{type:"line"},title:{text:null},xAxis:{type:"datetime",labels:{formatter:function(){return moment.unix(this.value).format("hh:mm A")}}},yAxis:{title:{text:"Bytes/sec"}},tooltip:{shared:!0,formatter:function(){var e="<b>"+moment.unix(this.x).format("MMM D, YYYY hh:mm A")+"</b><br/>";return $.each(this.points,function(t,s){e+='<span style="color:'+s.color+'">●</span> '+s.series.name+": <b>"+s.y+"</b><br/>"}),e}},credits:{enabled:!1},series:e.series})},fetchServerLogs:function(){App.blockElement(serverLogs),App.ajax(App.baseUrl("server/getServerLogs"),"get","json",{pageToken:serverLogsPageToken}).error(function(e){}).done(function(e){App.unblockElement(serverLogs),Server.loadServerLogs(e)})},loadServerLogs:function(e){$.each(e.entries,function(e,t){var s="log"+t.insertId;$('                    <div class="list-group-item media">                        <span class="pull-left">                            <button class="btn btn-default btn-icon btn-logs btn-expand waves-effect waves-circle">                                <i class="zmdi zmdi-plus"></i>                            </button>                        </span>                        <div class="media-body">                            <div class="lgi-heading"> '+moment(t.timestamp).format("MMM DD, YYYY hh:mm:ss")+" - "+t.textPayload+'</div>                        </div>                        <div class="media-body media-content" style="display: none;">                            <pre id="'+s+'"></pre>                        </div>                    </div>                ').insertBefore("#server-logs-load-more"),$("#"+s).jJsonViewer(JSON.stringify(t,null,4))}),serverLogsLoadMore.find("button").val(e.pageToken)}};